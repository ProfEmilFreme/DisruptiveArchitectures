<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <title>MQTT - Disruptive Architectures</title>
        <link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css">
        <link rel="stylesheet" href="/DisruptiveArchitectures/assets/css/main.css" id="maincss">
    </head>
    <body>
        <nav>
    
    <a href="#" onclick="toggle_menu()" id="hamb_menu">☰</a>
    
    <a href="/DisruptiveArchitectures/">Index</a>&nbsp;
    <a href="#" onclick="toggle_themes()">Mudar Tema</a>
</nav>

        <aside id="course_menu">
    
    
    <b class="course_name">Disruptive Architectures</b>

    
    <b class="section_name">Sobre a disciplina</b>
    
    
    <a href="/classes/00_index.html" class="class_link">Introdução</a>
    
    <a href="/classes/01_definicoes.html" class="class_link">Definições de IoT</a>
    
    <a href="/classes/02_avaliacoes.html" class="class_link">Avaliações</a>
    
    
    <b class="section_name">Eletrônica Básica</b>
    
    
    <a href="/classes/10_circuitoseletricos.html" class="class_link">Circuitos Simples</a>
    
    <a href="/classes/14_desafios.html" class="class_link">Desfios! #01</a>
    
    
    <b class="section_name">Sistemas Embarcados</b>
    
    
    <a href="/classes/20_sistemas_embarcados.html" class="class_link">Introdução</a>
    
    <a href="/classes/22_esp32.html" class="class_link">ESP32</a>
    
    <a href="/classes/21_arduino.html" class="class_link">Arduino</a>
    
    
    <b class="section_name">Protocolos M2M</b>
    
    
    <a href="/classes/30_m2m.html" class="class_link">Introdução</a>
    
    <a href="/classes/31_UART.html" class="class_link">UART</a>
    
    <a href="/classes/32_I2C.html" class="class_link">I2C</a>
    
    <a href="/classes/33_SPI.html" class="class_link">SPI</a>
    
    
    <b class="section_name">Backend</b>
    
    
    <a href="/classes/40_node_red.html" class="class_link">Node-Red</a>
    
    <a href="/classes/41_python.html" class="class_link">Python</a>
    
    
    <b class="section_name">Protocolos TCP/IP (Aplicação)</b>
    
    
    <a href="/classes/50_http.html" class="class_link">HTTP</a>
    
    <a href="/classes/51_MQTT.html" class="class_link">MQTT</a>
    
    <a href="/classes/52_WebSocket.html" class="class_link">WebSocket</a>
    
    
    <b class="section_name">Soluções</b>
    
    
    <a href="/classes/92_desafios_sol.html" class="class_link">Desfios! #01</a>
    
    


  
</aside>

        <aside id="toc_menu" style="float:right"> 
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#mqtt-broker">MQTT Broker</a>
<ul>
<li class="toc-entry toc-h2"><a href="#mqtt-local-mosquitto">MQTT Local: Mosquitto</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#mqtt-client">MQTT Client</a>
<ul>
<li class="toc-entry toc-h2"><a href="#programa-mqtt-ping-pong-esp32">Programa “MQTT Ping Pong” ESP32</a></li>
<li class="toc-entry toc-h2"><a href="#programa-mqtt-ping-pong-no-node-red">Programa “MQTT Ping Pong” No Node-Red</a></li>
</ul>
</li>
</ul>
</aside>

        <main>
            <div style="font-size:1.1em;font-weight:700;margin:1em"
                class="highlight">
                class
                <span class="nc ">MQTT</span>
                : public
                
                <span class="nc ">Disruptive Architectures</span>
                
                , public
                <span class="nc ">Protocolos TCP/IP (Aplicação)</span> 
                
            </div> 
            <center><h1> MQTT</h1></center>
            <p>O Protocolo MQTT nasce para aplicações IoT, e por isso conta com um pacote
pequeno, assim é possivel diminuir o a quantidade de dados que trafega em nossa
rede. Sua principal caracteristica é utilizar uma arquitetura de
publicação/inscrição (<em>publish/subscribe</em>), isso permite uma grande
desacoplamento entre os elementos que forma sua solução IoT.</p>

<p>Assim como a maioria dos protocolos TCP/IP, no MQTT também existe o modelo
Cliente/Servidor, contudo os clientes não se comunicam diretamente com o
servidor para solicitar e receber dados, como acontece no HTTP, temos um
servidor MQTT que é um Broker atuando como intermediário ente os clientes. Os
clientes, podem publicar mensagens em tópicos, ou se inscrever para receber
mensagens de tópicos específicos. O Broker gerencia essa comunicação: recebe as
mensagens publicadas e distribui para os clientes inscritos. Dessa forma não
existe necessidade de quem publica saber quem se inscreve e vice-e-versa,
garantindo um desacoplamento entre as partes de seu sistema.</p>

<p><img src="assets/mqtt01.png" alt=""></p>

<h1 id="mqtt-broker">
<a class="anchor" href="#mqtt-broker" aria-hidden="true"><span class="octicon octicon-link"></span></a>MQTT Broker</h1>

<p>Para fazer os teste iniciais, existem algumas soluções de MQTT Brokers
prontos que podemos utilizar, como o <code class="language-plaintext highlighter-rouge">test.mosquito.org</code> do projeto Eclipse
Mosquitto, <code class="language-plaintext highlighter-rouge">broker.hivemq.com</code> da plataforma HiveMQ, e <code class="language-plaintext highlighter-rouge">broker.emqx.io</code> da
plataforma EMQX, todos esses citados podem ser utilizado a fim de estudos e
testes, contúdo para a entrega de um projeto eles não devem ser utilizados.</p>

<p>Para fazer o deploy em projetos reails, existem diversas opções, como as
plataformas já citadas, HiveMQ e EMQX, e também os grande players de cloud, como
AWS (IoT Core), GCP (IoT Core) e Azure (IoT Hub) só para citar alguns que
fornecem a solução do MQTT broker gerênciado em suas plataformas.</p>

<p>Também podemos configurar um broker localmente para testes, e para isso o
Eclipse Mosquitto é uma das melhores opções, pois é leve, open-source e
amplamente utilizado para desenvolvimento e validação de soluções MQTT.</p>

<h2 id="mqtt-local-mosquitto">
<a class="anchor" href="#mqtt-local-mosquitto" aria-hidden="true"><span class="octicon octicon-link"></span></a>MQTT Local: Mosquitto</h2>

<p>Em um ambiente Linux, com suporte a <code class="language-plaintext highlighter-rouge">snap</code>, podemos instalar com o comando</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo snap install mosquitto
</code></pre></div></div>

<p>Depois da instalação, o serviço do mosquitto já estará rodando, e poderemos
fazer a inscrição e envio de dados com os comandos <code class="language-plaintext highlighter-rouge">mosquitto_sub</code> e
<code class="language-plaintext highlighter-rouge">mosquitto_pub</code> respectivamente.</p>

<p><img src="assets/mqtt_local_01.png" alt=""></p>

<p>Da forma que está mostrado na captura de tela estamos criando uma inscrição e
uma publicação para o serviço MQTT que está rodando localmente, ou seja
<code class="language-plaintext highlighter-rouge">localhost</code> dentro da mesma máquina. Para acessar o serviço de outros
dispositivos dentro da mesma rede local, precisamos saber o IP do computador que
instalamos o Mosquitto. Caso esteja disponível na internet, utilizamos o
endereço público para esta conexão.</p>

<h1 id="mqtt-client">
<a class="anchor" href="#mqtt-client" aria-hidden="true"><span class="octicon octicon-link"></span></a>MQTT Client</h1>

<p>Agora que já entendemos o papel o Broker, vamos olhar para os
clientes, que é qualquer dispositivo que consiga se conectar à rede de internet
ou local, a depender da sua solução. Em outras palavras, pode ser um computador,
uma Raspberry Pi, uma ESP32, ou qualquer outro controlador de IoT com interface de
rede e suporte ao protocolo MQTT.</p>

<p>Esses cliente que irão se inscrever ou publicar em tópicos, utilizando o Broker
como intermediário.</p>

<h2 id="programa-mqtt-ping-pong-esp32">
<a class="anchor" href="#programa-mqtt-ping-pong-esp32" aria-hidden="true"><span class="octicon octicon-link"></span></a>Programa “MQTT Ping Pong” ESP32</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;WiFi.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;PubSubClient.h&gt;</span><span class="cp">
</span>
<span class="c1">// --- Configuration ---</span>
<span class="c1">// Update with your Wi-Fi credentials</span>
<span class="k">const</span> <span class="n">String</span> <span class="n">ssid</span> <span class="o">=</span> <span class="s">"Wokwi-GUEST"</span><span class="p">;</span>
<span class="k">const</span> <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

<span class="c1">// Update with your MQTT broker's address</span>
<span class="k">const</span> <span class="n">String</span> <span class="n">client_id</span> <span class="o">=</span> <span class="s">"ef-esp32-pingpong-client"</span><span class="p">;</span>
<span class="k">const</span> <span class="n">String</span>  <span class="n">mqtt_server</span> <span class="o">=</span> <span class="s">"broker.mqttdashboard.com"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">mqtt_port</span> <span class="o">=</span> <span class="mi">1883</span><span class="p">;</span>

<span class="c1">// Define the MQTT topic for the ping-pong</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">topic</span> <span class="o">=</span> <span class="s">"ef/esp32/pingpong"</span><span class="p">;</span>
<span class="c1">// --- End of Configuration ---</span>

<span class="kt">int</span> <span class="n">ping_pong_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">WiFiClient</span> <span class="n">espClient</span><span class="p">;</span>
<span class="n">PubSubClient</span> <span class="nf">client</span><span class="p">(</span><span class="n">espClient</span><span class="p">);</span>

<span class="kt">long</span> <span class="n">lastMsg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">msg</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">// This function is called whenever a message arrives on a subscribed topic</span>
<span class="kt">void</span> <span class="nf">callback</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">topic</span><span class="p">,</span> <span class="n">byte</span><span class="o">*</span> <span class="n">payload</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Message arrived on topic: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">". Message: "</span><span class="p">);</span>
  <span class="n">String</span> <span class="n">message</span><span class="p">;</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">message</span> <span class="o">+=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">message</span> <span class="o">==</span> <span class="s">"PING"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Received PING..."</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">message</span> <span class="o">==</span> <span class="s">"PONG"</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Received PONG..."</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Reconnects to the MQTT broker if the connection is lost</span>
<span class="kt">void</span> <span class="nf">reconnect</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Loop until we're reconnected</span>
  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Attempting MQTT connection..."</span><span class="p">);</span>
    
    <span class="c1">// Attempt to connect</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">client_id</span><span class="p">.</span><span class="n">c_str</span><span class="p">()))</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"connected!"</span><span class="p">);</span>

      <span class="c1">// Subscribe to the topic</span>
      <span class="n">client</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Subscribed to topic: "</span><span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
      
      <span class="k">if</span><span class="p">(</span><span class="n">ping_pong_state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="c1">// Publish the initial "PING" message to start the loop</span>
        <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="s">"PING"</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Send Ping"</span><span class="p">);</span>
        <span class="n">ping_pong_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span><span class="p">{</span>
        <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="s">"PONG"</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Send PONG"</span><span class="p">);</span>
        <span class="n">ping_pong_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"failed, rc="</span><span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">state</span><span class="p">());</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">" try again in 5 seconds"</span><span class="p">);</span>
      <span class="c1">// Wait 5 seconds before retrying</span>
      <span class="n">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>

  <span class="c1">// Connect to Wi-Fi</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Connecting to "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">ssid</span><span class="p">);</span>

  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"WiFi connected"</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"IP address: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>

  <span class="c1">// Configure MQTT client</span>
  <span class="n">client</span><span class="p">.</span><span class="n">setServer</span><span class="p">(</span><span class="n">mqtt_server</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">mqtt_port</span><span class="p">);</span>
  <span class="n">client</span><span class="p">.</span><span class="n">setCallback</span><span class="p">(</span><span class="n">callback</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">reconnect</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="c1">// This allows the client to process incoming messages and maintain its connection</span>
  <span class="n">client</span><span class="p">.</span><span class="n">loop</span><span class="p">();</span> 
<span class="p">}</span>
</code></pre></div></div>

<h2 id="programa-mqtt-ping-pong-no-node-red">
<a class="anchor" href="#programa-mqtt-ping-pong-no-node-red" aria-hidden="true"><span class="octicon octicon-link"></span></a>Programa “MQTT Ping Pong” No Node-Red</h2>

<p><img src="assets/node_red_ping_pong.png" alt=""></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"388440c46d7e221d"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"tab"</span><span class="p">,</span><span class="nl">"label"</span><span class="p">:</span><span class="s2">"Flow 1"</span><span class="p">,</span><span class="nl">"disabled"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"info"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"env"</span><span class="p">:[]},{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"bcad16c131945d35"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"mqtt in"</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="s2">"388440c46d7e221d"</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ef_nr_test"</span><span class="p">,</span><span class="nl">"qos"</span><span class="p">:</span><span class="s2">"2"</span><span class="p">,</span><span class="nl">"datatype"</span><span class="p">:</span><span class="s2">"auto-detect"</span><span class="p">,</span><span class="nl">"broker"</span><span class="p">:</span><span class="s2">"1904db3f823efbe2"</span><span class="p">,</span><span class="nl">"nl"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"rap"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"rh"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"inputs"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"x"</span><span class="p">:</span><span class="mi">320</span><span class="p">,</span><span class="nl">"y"</span><span class="p">:</span><span class="mi">260</span><span class="p">,</span><span class="nl">"wires"</span><span class="p">:[[</span><span class="s2">"ab369d63761969a7"</span><span class="p">]]},{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"ab369d63761969a7"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"debug"</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="s2">"388440c46d7e221d"</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"debug 1"</span><span class="p">,</span><span class="nl">"active"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"tosidebar"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"console"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"tostatus"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"complete"</span><span class="p">:</span><span class="s2">"payload"</span><span class="p">,</span><span class="nl">"targetType"</span><span class="p">:</span><span class="s2">"msg"</span><span class="p">,</span><span class="nl">"statusVal"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"statusType"</span><span class="p">:</span><span class="s2">"auto"</span><span class="p">,</span><span class="nl">"x"</span><span class="p">:</span><span class="mi">530</span><span class="p">,</span><span class="nl">"y"</span><span class="p">:</span><span class="mi">260</span><span class="p">,</span><span class="nl">"wires"</span><span class="p">:[]},{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"d0d229874fb1161d"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"mqtt out"</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="s2">"388440c46d7e221d"</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ef_nr_test"</span><span class="p">,</span><span class="nl">"qos"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"retain"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"respTopic"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"contentType"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"userProps"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"correl"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"expiry"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"broker"</span><span class="p">:</span><span class="s2">"1904db3f823efbe2"</span><span class="p">,</span><span class="nl">"x"</span><span class="p">:</span><span class="mi">540</span><span class="p">,</span><span class="nl">"y"</span><span class="p">:</span><span class="mi">340</span><span class="p">,</span><span class="nl">"wires"</span><span class="p">:[]},{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"f7a36b9a52ff6386"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"inject"</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="s2">"388440c46d7e221d"</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"props"</span><span class="p">:[{</span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"payload"</span><span class="p">},{</span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"topic"</span><span class="p">,</span><span class="nl">"vt"</span><span class="p">:</span><span class="s2">"str"</span><span class="p">}],</span><span class="nl">"repeat"</span><span class="p">:</span><span class="s2">"5"</span><span class="p">,</span><span class="nl">"crontab"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"once"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"onceDelay"</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"payload"</span><span class="p">:</span><span class="s2">"Ping"</span><span class="p">,</span><span class="nl">"payloadType"</span><span class="p">:</span><span class="s2">"str"</span><span class="p">,</span><span class="nl">"x"</span><span class="p">:</span><span class="mi">330</span><span class="p">,</span><span class="nl">"y"</span><span class="p">:</span><span class="mi">340</span><span class="p">,</span><span class="nl">"wires"</span><span class="p">:[[</span><span class="s2">"d0d229874fb1161d"</span><span class="p">]]},{</span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1904db3f823efbe2"</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"mqtt-broker"</span><span class="p">,</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"broker"</span><span class="p">:</span><span class="s2">"localhost"</span><span class="p">,</span><span class="nl">"port"</span><span class="p">:</span><span class="mi">1883</span><span class="p">,</span><span class="nl">"clientid"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"autoConnect"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"usetls"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nl">"protocolVersion"</span><span class="p">:</span><span class="s2">"5"</span><span class="p">,</span><span class="nl">"keepalive"</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span><span class="nl">"cleansession"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"autoUnsubscribe"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nl">"birthTopic"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"birthQos"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="nl">"birthRetain"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="nl">"birthPayload"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"birthMsg"</span><span class="p">:{},</span><span class="nl">"closeTopic"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"closeQos"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="nl">"closeRetain"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="nl">"closePayload"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"closeMsg"</span><span class="p">:{},</span><span class="nl">"willTopic"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"willQos"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="nl">"willRetain"</span><span class="p">:</span><span class="s2">"false"</span><span class="p">,</span><span class="nl">"willPayload"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"willMsg"</span><span class="p">:{},</span><span class="nl">"userProps"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"sessionExpiry"</span><span class="p">:</span><span class="s2">""</span><span class="p">}]</span><span class="w">
</span></code></pre></div></div>

            <div style="font-size:1.1em;font-weight:700;margin:1em"
                class="highlight">
                class
                <span class="nc ">MQTT</span>
                : public
                <span class="nc ">Disruptive Architectures</span>
                
                , public
                <span class="nc ">Protocolos TCP/IP (Aplicação)</span> 
                
            </div> 
        </main>
        <script type="text/javascript" src="/DisruptiveArchitectures/assets/scripts.js"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://tikzjax.com/v1/tikzjax.js"></script>
        <script src=" https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js "></script>
        <script type="module">
            mermaid.initialize({theme:"neutral",
                                securityLevel: "strict",
                                startOnLoad: true
                                });
        </script>
    </body>
</html>
